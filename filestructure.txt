1. Prometheus File Structure (Production Standard)
/opt/prometheus/                # Prometheus binaries only
â”‚â”€â”€ prometheus                  # main server binary
â”‚â”€â”€ promtool                    # validation & debugging tool
â”‚â”€â”€ consoles/                   # HTML dashboards (built-in)
â”‚â”€â”€ console_libraries/          # JS/CSS libs for consoles

/etc/prometheus/                # ALL config files (clean separation)
â”‚â”€â”€ prometheus.yml              # main config (jobs, scrape targets)
â”‚â”€â”€ rules/                      # (optional) alert & recording rules
â”‚     â””â”€â”€ *.rules.yml

/var/lib/prometheus/            # TSDB database (actual metric storage)
â”‚â”€â”€ chunks_head/                # in-memory chunks
â”‚â”€â”€ wal/                        # write-ahead-log
â”‚â”€â”€ lock                        # TSDB lock file
â”‚â”€â”€ queries.active              # active query metadata

/etc/systemd/system/
â”‚â”€â”€ prome.service               # Prometheus systemd service

ğŸ”¥ Why this structure?

/opt = vendor binaries

/etc = configuration

/var/lib = persistent data

/etc/systemd/system = service control

This split is required if you want production reliability and clean backup/versioning.

âœ… 2. Node Exporter File Structure
/opt/node_exporter/             # Node Exporter binary only
â”‚â”€â”€ node_exporter

/etc/systemd/system/
â”‚â”€â”€ node_exporter.service       # systemd service file

ğŸ”¥ Why this structure?

Node exporter has no config; only one binary

Runs as a non-root user

Must be clean & isolated

âœ… 3. Grafana File Structure (installed via Yum repo)
/etc/grafana/                   # Grafana configuration
â”‚â”€â”€ grafana.ini                 # main config file
â”‚â”€â”€ provisioning/
â”‚     â”œâ”€â”€ datasources/          # auto-provision Prometheus datasource
â”‚     â”œâ”€â”€ dashboards/           # auto-load dashboard json files
â”‚     â””â”€â”€ notifiers/            # alert channels

/var/lib/grafana/               # Grafana database + users + dashboards
â”‚â”€â”€ grafana.db                  # SQLite DB storing users, sessions
â”‚â”€â”€ plugins/                    # installed plugins

/var/log/grafana/               # logs
â”‚â”€â”€ grafana.log
â”‚â”€â”€ grafana.stdout
â”‚â”€â”€ grafana.stderr

/usr/share/grafana/             # graphical UI, public assets
â”‚â”€â”€ public/
â”‚â”€â”€ plugins-bundled/

/etc/systemd/system/ 
â”‚â”€â”€ grafana-server.service      # systemd service file (may also be under /usr/lib/systemd/system/)

ğŸ”¥ Why this structure?

/etc/grafana = static configs

/var/lib/grafana = dynamic data (DB, dashboards, plugins)

/var/log/grafana = logs

/usr/share/grafana = UI + frontend assets

ğŸ”¥ 4. Combined Final Monitoring Structure
/opt/
â”‚â”€â”€ prometheus/
â”‚â”€â”€ node_exporter/

/etc/
â”‚â”€â”€ prometheus/
â”‚â”€â”€ grafana/

/var/lib/
â”‚â”€â”€ prometheus/
â”‚â”€â”€ grafana/

/etc/systemd/system/
â”‚â”€â”€ prome.service
â”‚â”€â”€ node_exporter.service
â”‚â”€â”€ grafana-server.service


This is how a real company maintains monitoring for bare-metal or EC2-based environments.
ASCII Architecture Diagram â€” Prometheus Monitoring on Amazon Linux
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚        Grafana (Port 3000)     â”‚
                          â”‚   - Dashboards                 â”‚
                          â”‚   - Visualizations             â”‚
                          â”‚   - PromQL Queries             â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â”‚  reads data via HTTP API
                                          â”‚  (http://localhost:9090)
                                          â”‚
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚    Prometheus Server (9090)     â”‚
                          â”‚---------------------------------â”‚
                          â”‚ - Scrapes targets                â”‚
                          â”‚ - Stores TSDB data               â”‚
                          â”‚ - Runs rules (if configured)     â”‚
                          â”‚ - Provides API for Grafana       â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â”‚  pulls metrics every 15s
                                          â”‚  (scrape job: node_exporter)
                                          â”‚
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚         Node Exporter (Port 9100)             â”‚
                   â”‚---------------------------------------------- â”‚
                   â”‚ - Exposes Linux metrics:                      â”‚
                   â”‚     CPU, Memory, Disk, Network, Load, FS      â”‚
                   â”‚ - No config, only binary                      â”‚
                   â”‚ - Runs under node_exporter user               â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â”‚  reads from Linux /proc, /sys
                                          â–¼
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚  Amazon Linux  â”‚
                                 â”‚  EC2 Instance  â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ”¥ EXPLANATION OF THE FLOW (SHORT & CLEAR)
1) Node Exporter

Runs on EC2

Reads system metrics from /proc and /sys

Exposes metrics on localhost:9100/metrics

2) Prometheus

Scrapes Node Exporter every 15 seconds

Stores all metrics in TSDB (/var/lib/prometheus)

Exposes its own metrics & API on 9090

3) Grafana

Connects to Prometheus as a â€œdata sourceâ€

Executes PromQL queries

Draws dashboards using Prometheus time-series data

ğŸ’¥ ASCII Diagram â€” File Structure + Flow Combined
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
 EC2 HOST FILE STRUCTURE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
/opt/
   â”œâ”€â”€ prometheus/
   â”‚     â”œâ”€â”€ prometheus
   â”‚     â”œâ”€â”€ promtool
   â”‚     â”œâ”€â”€ consoles/
   â”‚     â””â”€â”€ console_libraries/
   â””â”€â”€ node_exporter/
         â””â”€â”€ node_exporter

/etc/
   â”œâ”€â”€ prometheus/
   â”‚     â””â”€â”€ prometheus.yml
   â””â”€â”€ grafana/
         â””â”€â”€ grafana.ini (and provisioning)

/var/lib/
   â”œâ”€â”€ prometheus/   (TSDB data)
   â””â”€â”€ grafana/      (dashboard DB + plugins)

/etc/systemd/system/
   â”œâ”€â”€ prome.service
   â”œâ”€â”€ node_exporter.service
   â””â”€â”€ grafana-server.service

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
 METRICS FLOW
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

[Linux Kernel] 
      â”‚
      â–¼
[Node Exporter :9100]
      â”‚ (scraped by)
      â–¼
[Prometheus :9090]
      â”‚ (queried by)
      â–¼
[Grafana :3000]  --> dashboards
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
